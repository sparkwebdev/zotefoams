{"version":3,"file":"critical.js","sources":["../src/utils/dom-utilities.js","../src/critical/navigation-keyboard.js","../src/critical/navigation.js"],"sourcesContent":["// =============================================================================\n// Zotefoams DOM Utilities - Core DOM manipulation utilities (ES Module)\n// =============================================================================\n\n/**\n * DOM Selection Utilities - Centralized element selection patterns\n */\nexport const ZotefoamsDOMUtils = {\n\t/**\n\t * Safe querySelector with optional fallback\n\t * @param selector\n\t * @param fallback\n\t */\n\tselect( selector, fallback = null ) {\n\t\tconst element = document.querySelector( selector );\n\t\treturn element || fallback;\n\t},\n\n\t/**\n\t * Safe querySelectorAll with guaranteed array return\n\t * @param selector\n\t */\n\tselectAll( selector ) {\n\t\treturn Array.from( document.querySelectorAll( selector ) );\n\t},\n\n\t/**\n\t * Select elements with data attribute\n\t * @param attribute\n\t * @param value\n\t */\n\tselectByData( attribute, value = null ) {\n\t\tconst selector = value ? `[data-${ attribute }=\"${ value }\"]` : `[data-${ attribute }]`;\n\t\treturn this.selectAll( selector );\n\t},\n\n\t/**\n\t * Safe closest selector with fallback\n\t * @param element\n\t * @param selector\n\t * @param fallback\n\t */\n\tclosest( element, selector, fallback = null ) {\n\t\treturn element?.closest( selector ) || fallback;\n\t},\n\n\t/**\n\t * Check if element exists and is visible\n\t * @param element\n\t */\n\tisVisible( element ) {\n\t\tif ( ! element ) {\n\t\t\treturn false;\n\t\t}\n\t\tconst rect = element.getBoundingClientRect();\n\t\treturn rect.width > 0 && rect.height > 0;\n\t},\n};\n\n/**\n * Event Handling Utilities - Centralized event management patterns\n */\nexport const ZotefoamsEventUtils = {\n\t/**\n\t * Add event listener with cleanup tracking\n\t * @param element\n\t * @param event\n\t * @param handler\n\t * @param options\n\t */\n\ton( element, event, handler, options = {} ) {\n\t\tif ( ! element ) {\n\t\t\treturn null;\n\t\t}\n\t\telement.addEventListener( event, handler, options );\n\t\treturn { element, event, handler };\n\t},\n\n\t/**\n\t * Add event listener to multiple elements\n\t * @param elements\n\t * @param event\n\t * @param handler\n\t * @param options\n\t */\n\tonAll( elements, event, handler, options = {} ) {\n\t\treturn elements.map( ( element ) => this.on( element, event, handler, options ) ).filter( Boolean );\n\t},\n\n\t/**\n\t * Delegated event handling for dynamic content\n\t * @param container\n\t * @param selector\n\t * @param event\n\t * @param handler\n\t */\n\tdelegate( container, selector, event, handler ) {\n\t\treturn this.on( container, event, ( e ) => {\n\t\t\tconst target = e.target.closest( selector );\n\t\t\tif ( target && container.contains( target ) ) {\n\t\t\t\thandler.call( target, e );\n\t\t\t}\n\t\t} );\n\t},\n\n\t/**\n\t * One-time event listener\n\t * @param element\n\t * @param event\n\t * @param handler\n\t */\n\tonce( element, event, handler ) {\n\t\treturn this.on( element, event, handler, { once: true } );\n\t},\n\n\t/**\n\t * Debounced event handler\n\t * @param func\n\t * @param wait\n\t */\n\tdebounce( func, wait ) {\n\t\tlet timeout;\n\t\treturn function executedFunction( ...args ) {\n\t\t\tconst later = () => {\n\t\t\t\tclearTimeout( timeout );\n\t\t\t\tfunc( ...args );\n\t\t\t};\n\t\t\tclearTimeout( timeout );\n\t\t\ttimeout = setTimeout( later, wait );\n\t\t};\n\t},\n};\n\n/**\n * CSS Class Utilities - Centralized class manipulation patterns\n */\nexport const ZotefoamsClassUtils = {\n\t/**\n\t * Toggle class on element safely\n\t * @param element\n\t * @param className\n\t * @param force\n\t */\n\ttoggle( element, className, force = undefined ) {\n\t\tif ( ! element ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn element.classList.toggle( className, force );\n\t},\n\n\t/**\n\t * Add class to element safely\n\t * @param          element\n\t * @param {...any} classNames\n\t */\n\tadd( element, ...classNames ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\telement.classList.add( ...classNames );\n\t},\n\n\t/**\n\t * Remove class from element safely\n\t * @param          element\n\t * @param {...any} classNames\n\t */\n\tremove( element, ...classNames ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\telement.classList.remove( ...classNames );\n\t},\n\n\t/**\n\t * Toggle class on multiple elements\n\t * @param elements\n\t * @param className\n\t * @param force\n\t */\n\ttoggleAll( elements, className, force = undefined ) {\n\t\treturn elements.map( ( element ) => this.toggle( element, className, force ) );\n\t},\n\n\t/**\n\t * Add class to multiple elements\n\t * @param          elements\n\t * @param {...any} classNames\n\t */\n\taddAll( elements, ...classNames ) {\n\t\telements.forEach( ( element ) => this.add( element, ...classNames ) );\n\t},\n\n\t/**\n\t * Remove class from multiple elements\n\t * @param          elements\n\t * @param {...any} classNames\n\t */\n\tremoveAll( elements, ...classNames ) {\n\t\telements.forEach( ( element ) => this.remove( element, ...classNames ) );\n\t},\n\n\t/**\n\t * Replace class on element\n\t * @param element\n\t * @param oldClass\n\t * @param newClass\n\t */\n\treplace( element, oldClass, newClass ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.remove( element, oldClass );\n\t\tthis.add( element, newClass );\n\t},\n};\n\n/**\n * Animation Utilities - Centralized animation patterns\n */\nexport const ZotefoamsAnimationUtils = {\n\t/**\n\t * Fade in element with class toggle\n\t * @param element\n\t * @param className\n\t */\n\tfadeIn( element, className = 'fade-in' ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\tZotefoamsClassUtils.add( element, className );\n\t},\n\n\t/**\n\t * Fade out element with class toggle\n\t * @param element\n\t * @param className\n\t */\n\tfadeOut( element, className = 'fade-in' ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\tZotefoamsClassUtils.remove( element, className );\n\t},\n\n\t/**\n\t * Show/hide element with smooth transition\n\t * @param element\n\t * @param show\n\t */\n\ttoggleVisibility( element, show ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( show ) {\n\t\t\telement.style.display = 'block';\n\t\t\telement.style.opacity = '1';\n\t\t\telement.style.maxHeight = '1000px';\n\t\t} else {\n\t\t\telement.style.display = 'none';\n\t\t\telement.style.opacity = '0';\n\t\t\telement.style.maxHeight = '0';\n\t\t}\n\t},\n\n\t/**\n\t * Smooth scroll to element\n\t * @param element\n\t * @param offset\n\t * @param behavior\n\t */\n\tscrollTo( element, offset = -80, behavior = 'smooth' ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\tconst targetPosition = element.getBoundingClientRect().top + window.pageYOffset + offset;\n\t\twindow.scrollTo( {\n\t\t\ttop: targetPosition,\n\t\t\tbehavior,\n\t\t} );\n\t},\n};\n\n/**\n * Touch/Device Detection Utilities\n */\nexport const ZotefoamsDeviceUtils = {\n\t/**\n\t * Detect touch device\n\t */\n\tisTouchDevice() {\n\t\treturn 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;\n\t},\n\n\t/**\n\t * Get interaction event based on device\n\t */\n\tgetInteractionEvent() {\n\t\treturn this.isTouchDevice() ? 'click' : 'hover';\n\t},\n\n\t/**\n\t * Apply touch-specific classes\n\t */\n\tinitTouchSupport() {\n\t\tif ( this.isTouchDevice() ) {\n\t\t\tZotefoamsClassUtils.add( document.body, 'touch-device' );\n\t\t} else {\n\t\t\tZotefoamsClassUtils.add( document.body, 'no-touch-device' );\n\t\t}\n\t},\n};\n\n/**\n * Form Utilities - Centralized form handling patterns\n */\nexport const ZotefoamsFormUtils = {\n\t/**\n\t * Get form data as object\n\t * @param form\n\t */\n\tgetFormData( form ) {\n\t\tif ( ! form ) {\n\t\t\treturn {};\n\t\t}\n\t\tconst formData = new FormData( form );\n\t\treturn Object.fromEntries( formData.entries() );\n\t},\n\n\t/**\n\t * Validate required fields\n\t * @param form\n\t */\n\tvalidateRequired( form ) {\n\t\tif ( ! form ) {\n\t\t\treturn false;\n\t\t}\n\t\tconst requiredFields = ZotefoamsDOMUtils.selectAll( 'input[required], textarea[required], select[required]' );\n\t\treturn requiredFields.every( ( field ) => field.value.trim() !== '' );\n\t},\n\n\t/**\n\t * Focus first invalid field\n\t * @param form\n\t */\n\tfocusFirstInvalid( form ) {\n\t\tif ( ! form ) {\n\t\t\treturn;\n\t\t}\n\t\tconst invalid = form.querySelector( ':invalid' );\n\t\tif ( invalid ) {\n\t\t\tinvalid.focus();\n\t\t}\n\t},\n};\n\n/**\n * URL/Navigation Utilities\n */\nexport const ZotefoamsURLUtils = {\n\t/**\n\t * Get URL parameter\n\t * @param name\n\t */\n\tgetParam( name ) {\n\t\tconst params = new URLSearchParams( window.location.search );\n\t\treturn params.get( name );\n\t},\n\n\t/**\n\t * Set URL parameter without reload\n\t * @param name\n\t * @param value\n\t */\n\tsetParam( name, value ) {\n\t\tconst params = new URLSearchParams( window.location.search );\n\t\tparams.set( name, value );\n\t\tconst newURL = window.location.pathname + '?' + params.toString();\n\t\twindow.history.replaceState( {}, '', newURL );\n\t},\n\n\t/**\n\t * Get hash without #\n\t */\n\tgetHash() {\n\t\treturn window.location.hash.substring( 1 );\n\t},\n\n\t/**\n\t * Set hash without reload\n\t * @param hash\n\t */\n\tsetHash( hash ) {\n\t\twindow.history.replaceState( null, '', '#' + hash );\n\t},\n};\n\n/**\n * Accessibility Utilities - Keyboard navigation and ARIA support\n */\nexport const ZotefoamsAccessibilityUtils = {\n\t/**\n\t * Get all focusable elements within a container\n\t * @param {HTMLElement} container - Container element to search within\n\t * @return {Array<HTMLElement>} Array of focusable elements\n\t */\n\tgetFocusableElements( container ) {\n\t\tif ( ! container ) {\n\t\t\treturn [];\n\t\t}\n\t\treturn Array.from(\n\t\t\tcontainer.querySelectorAll(\n\t\t\t\t'a, button, input, textarea, select, [tabindex]:not([tabindex=\"-1\"])'\n\t\t\t)\n\t\t);\n\t},\n\n\t/**\n\t * Set aria-expanded attribute\n\t * @param {HTMLElement} element  - Element to update\n\t * @param {boolean}     expanded - Expanded state\n\t */\n\tsetAriaExpanded( element, expanded ) {\n\t\tif ( element ) {\n\t\t\telement.setAttribute( 'aria-expanded', expanded.toString() );\n\t\t}\n\t},\n\n\t/**\n\t * Set multiple ARIA attributes at once\n\t * @param {HTMLElement} element    - Element to update\n\t * @param {Object}      attributes - Object with ARIA attribute names and values\n\t */\n\tsetAriaAttributes( element, attributes ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\tObject.entries( attributes ).forEach( ( [ key, value ] ) => {\n\t\t\telement.setAttribute( key, value.toString() );\n\t\t} );\n\t},\n\n\t/**\n\t * Toggle aria-hidden state\n\t * @param {HTMLElement} element - Element to update\n\t * @param {boolean}     hidden  - Hidden state\n\t */\n\tsetAriaHidden( element, hidden ) {\n\t\tif ( element ) {\n\t\t\telement.setAttribute( 'aria-hidden', hidden.toString() );\n\t\t}\n\t},\n\n\t/**\n\t * Focus element with optional trap\n\t * @param {HTMLElement} element     - Element to focus\n\t * @param {boolean}     setTabindex - Whether to set tabindex=\"-1\" for non-focusable elements\n\t */\n\tfocus( element, setTabindex = false ) {\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( setTabindex && ! element.hasAttribute( 'tabindex' ) ) {\n\t\t\telement.setAttribute( 'tabindex', '-1' );\n\t\t}\n\t\telement.focus();\n\t},\n};\n\n/**\n * Ready State Utilities - Centralized DOMContentLoaded patterns\n */\nexport const ZotefoamsReadyUtils = {\n\t/**\n\t * Execute function when DOM is ready\n\t * @param callback\n\t */\n\tready( callback ) {\n\t\tif ( document.readyState === 'loading' ) {\n\t\t\tdocument.addEventListener( 'DOMContentLoaded', callback );\n\t\t} else {\n\t\t\tcallback();\n\t\t}\n\t},\n\n\t/**\n\t * Execute multiple functions when DOM is ready\n\t * @param callbacks\n\t */\n\treadyAll( callbacks ) {\n\t\tthis.ready( () => {\n\t\t\tcallbacks.forEach( ( callback ) => {\n\t\t\t\ttry {\n\t\t\t\t\tcallback();\n\t\t\t\t} catch ( error ) {\n\t\t\t\t\tconsole.error( 'Ready callback error:', error );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t},\n};\n","/**\n * Navigation Keyboard Handlers - Accessibility support for keyboard navigation\n * @version 1.3 - Removed updateMegaContainer (container deleted)\n */\n\nimport { ZotefoamsAccessibilityUtils } from '../utils/dom-utilities.js';\n\n// Re-export utilities for convenience\nexport const { getFocusableElements, setAriaExpanded } = ZotefoamsAccessibilityUtils;\n\n/**\n * Handle keyboard navigation within mega menus (Tab, Escape)\n * @param {KeyboardEvent} e           - Keyboard event\n * @param {HTMLElement}   megaMenu    - Mega menu element\n * @param {HTMLElement}   triggerLink - Link that triggers the menu\n */\nexport const handleMegaMenuKeyboard = ( e, megaMenu, triggerLink ) => {\n\tif ( e.key === 'Escape' ) {\n\t\te.preventDefault();\n\t\tmegaMenu.setAttribute( 'aria-hidden', 'true' );\n\t\tsetAriaExpanded( triggerLink, false );\n\t\ttriggerLink.focus();\n\t\treturn;\n\t}\n\n\tif ( e.key === 'Tab' ) {\n\t\tconst focusable = getFocusableElements( megaMenu );\n\t\tconst currentIndex = focusable.indexOf( document.activeElement );\n\t\tconst isFirst = currentIndex === 0;\n\t\tconst isLast = currentIndex === focusable.length - 1;\n\n\t\t// Tab out of menu when reaching boundaries\n\t\tif ( ( e.shiftKey && isFirst ) || ( ! e.shiftKey && isLast ) ) {\n\t\t\te.preventDefault();\n\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\tsetAriaExpanded( triggerLink, false );\n\n\t\t\t// Focus next/previous top-level link\n\t\t\tconst topLinks = Array.from( document.querySelectorAll( \"[data-js-nav='menu'] > li > a\" ) );\n\t\t\tconst index = topLinks.indexOf( triggerLink );\n\t\t\tconst targetLink = e.shiftKey\n\t\t\t\t? ( index > 0 ? topLinks[ index - 1 ] : triggerLink )\n\t\t\t\t: ( index < topLinks.length - 1 ? topLinks[ index + 1 ] : triggerLink );\n\t\t\ttargetLink.focus();\n\t\t}\n\t}\n};\n\n/**\n * Handle keyboard activation for menu items (Enter, Space, ArrowDown)\n * @param {KeyboardEvent} e        - Keyboard event\n * @param {HTMLElement}   link     - Menu item link\n * @param {HTMLElement}   megaMenu - Mega menu element\n * @param {Function}      closeAll - Callback to close all menus\n */\nexport const handleMenuItemKeyboard = ( e, link, megaMenu, closeAll ) => {\n\tif ( e.key === 'Enter' || e.key === ' ' || e.key === 'ArrowDown' ) {\n\t\te.preventDefault();\n\n\t\tconst isOpen = megaMenu.getAttribute( 'aria-hidden' ) === 'false';\n\n\t\tif ( isOpen ) {\n\t\t\t// Close if already open\n\t\t\tif ( e.key === 'ArrowDown' ) {\n\t\t\t\t// Move focus into menu\n\t\t\t\tconst firstFocusable = getFocusableElements( megaMenu )[ 0 ];\n\t\t\t\tif ( firstFocusable ) {\n\t\t\t\t\tfirstFocusable.focus();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\tsetAriaExpanded( link, false );\n\t\t} else {\n\t\t\t// Open menu\n\t\t\tcloseAll();\n\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'false' );\n\t\t\tsetAriaExpanded( link, true );\n\n\t\t\t// Focus heading for screen readers\n\t\t\tconst heading = megaMenu.querySelector( '.mega-menu-intro > h2' );\n\t\t\tif ( heading ) {\n\t\t\t\theading.setAttribute( 'tabindex', '-1' );\n\t\t\t\tsetTimeout( () => heading.focus(), 200 );\n\t\t\t}\n\t\t}\n\t} else if ( e.key === 'Escape' ) {\n\t\tcloseAll();\n\t\tlink.focus();\n\t}\n};\n","/**\n * Navigation.js - Simplified navigation with accessibility support\n * @version 0.13 - Mobile nav closes on Tab from last item\n */\n\nimport {\n\tsetAriaExpanded,\n\thandleMegaMenuKeyboard,\n\thandleMenuItemKeyboard,\n\tgetFocusableElements,\n} from './navigation-keyboard.js';\n\nimport { ZotefoamsDeviceUtils } from '../utils/dom-utilities.js';\n\n( () => {\n\ttry {\n\t\t// CRITICAL: Initialize touch detection FIRST, before any navigation logic\n\t\t// This must run before initNavigation() checks for touch-device class\n\t\tif ( document.body ) {\n\t\t\tZotefoamsDeviceUtils.initTouchSupport();\n\t\t}\n\n\t\tconsole.log( '[Navigation v1.0.1] Script loaded' );\n\n\t\tfunction initNavigation() {\n\t\t\tconst siteNav = document.querySelector( \"[data-js-nav='main']\" );\n\t\t\tif ( ! siteNav || siteNav.hasAttribute( 'data-critical-nav-initialized' ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst button = document.querySelector( \"[data-js-nav='toggle']\" );\n\t\t\tconst menu = document.querySelector( \"[data-js-nav='menu']\" );\n\t\t\tconst utilityMenu = document.querySelector( \"[data-js-nav='utility']\" );\n\n\t\t\tif ( ! button || ! menu ) {\n\t\t\t\tif ( ! menu && button ) {\n\t\t\t\t\tbutton.style.display = 'none';\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Check if touch-device class exists (added by dom-utilities.js)\n\t\t\tconst isTouchDevice = document.body.classList.contains( 'touch-device' );\n\t\t\tconst megaNavMode = isTouchDevice ? 'click' : 'hover';\n\t\t\tconst HOVER_DELAY_MS = 200;\n\n\t\t\t// Prevent accidental hover activation on page load (when mouse is already over nav)\n\t\t\tlet allowHover = false;\n\t\t\twindow.addEventListener( 'mousemove', () => {\n\t\t\t\tallowHover = true;\n\t\t\t}, { once: true } );\n\n\t\t\t// Single timer for hide delays\n\t\t\tlet hideTimer = null;\n\n\t\t\t// =========================================================================\n\t\t\t// UTILITY FUNCTIONS\n\t\t\t// =========================================================================\n\t\t\t/**\n\t\t\t * Close all mega menus\n\t\t\t */\n\t\t\tconst closeMegaMenus = () => {\n\t\t\t\tif ( hideTimer ) {\n\t\t\t\t\tclearTimeout( hideTimer );\n\t\t\t\t\thideTimer = null;\n\t\t\t\t}\n\n\t\t\t\tdocument.querySelectorAll( \".mega-menu[aria-hidden='false']\" )\n\t\t\t\t\t.forEach( ( menu ) => {\n\t\t\t\t\t\tmenu.setAttribute( 'aria-hidden', 'true' );\n\n\t\t\t\t\t\tconst menuId = menu.getAttribute( 'id' );\n\t\t\t\t\t\tconst triggerLink = document.querySelector( `[aria-controls=\"${ menuId }\"]` );\n\t\t\t\t\t\tif ( triggerLink ) {\n\t\t\t\t\t\t\tsetAriaExpanded( triggerLink, false );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Close all utility menu dropdowns\n\t\t\t */\n\t\t\tconst closeUtilityMenus = () => {\n\t\t\t\tdocument.querySelectorAll( \"[data-js-nav='utility'] a[aria-expanded='true']\" )\n\t\t\t\t\t.forEach( ( link ) => {\n\t\t\t\t\t\tsetAriaExpanded( link, false );\n\t\t\t\t\t\tconst submenuId = link.getAttribute( 'aria-controls' );\n\t\t\t\t\t\tconst submenu = document.getElementById( submenuId );\n\t\t\t\t\t\tif ( submenu ) {\n\t\t\t\t\t\t\tsubmenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Close all menus\n\t\t\t */\n\t\t\tconst closeAll = () => {\n\t\t\t\tif ( hideTimer ) {\n\t\t\t\t\tclearTimeout( hideTimer );\n\t\t\t\t\thideTimer = null;\n\t\t\t\t}\n\t\t\t\tcloseMegaMenus();\n\t\t\t\tcloseUtilityMenus();\n\t\t\t};\n\n\t\t\t// =========================================================================\n\t\t\t// HAMBURGER MENU TOGGLE\n\t\t\t// =========================================================================\n\t\t\tbutton.addEventListener( 'click', () => {\n\t\t\t\tconst isExpanded = siteNav.classList.toggle( 'toggled' );\n\t\t\t\tsetAriaExpanded( button, isExpanded );\n\t\t\t\tdocument.body.classList.toggle( 'no-scroll', isExpanded );\n\t\t\t} );\n\n\t\t\t// Mobile nav keyboard handling - close on Tab from last item\n\t\t\tsiteNav.addEventListener( 'keydown', ( e ) => {\n\t\t\t\tif ( e.key === 'Tab' && ! e.shiftKey ) {\n\t\t\t\t\t// Only when nav is open\n\t\t\t\t\tif ( siteNav.classList.contains( 'toggled' ) ) {\n\t\t\t\t\t\tconst focusable = getFocusableElements( siteNav );\n\t\t\t\t\t\tconst lastFocusable = focusable[ focusable.length - 1 ];\n\n\t\t\t\t\t\t// If we're on the last focusable element\n\t\t\t\t\t\tif ( document.activeElement === lastFocusable ) {\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t// Close nav\n\t\t\t\t\t\t\tsiteNav.classList.remove( 'toggled' );\n\t\t\t\t\t\t\tsetAriaExpanded( button, false );\n\t\t\t\t\t\t\tdocument.body.classList.remove( 'no-scroll' );\n\n\t\t\t\t\t\t\t// Focus hamburger button after DOM updates\n\t\t\t\t\t\t\tsetTimeout( () => button.focus(), 0 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// =========================================================================\n\t\t\t// DROPDOWN TOGGLE BUTTONS (Mobile sub-menus)\n\t\t\t// =========================================================================\n\t\t\tconst setupDropdownToggles = ( container ) => {\n\t\t\t\tcontainer.querySelectorAll( '.dropdown-toggle' ).forEach( ( toggle, index ) => {\n\t\t\t\t\tconst submenu = toggle.parentNode.querySelector( ':scope > ul' );\n\n\t\t\t\t\tif ( submenu ) {\n\t\t\t\t\t\tconst submenuId = `mobile-submenu-${ index }`;\n\t\t\t\t\t\tsubmenu.setAttribute( 'id', submenuId );\n\t\t\t\t\t\ttoggle.setAttribute( 'aria-controls', submenuId );\n\t\t\t\t\t\ttoggle.setAttribute( 'aria-expanded', 'false' );\n\n\t\t\t\t\t\ttoggle.addEventListener( 'click', ( e ) => {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\tconst isExpanded = toggle.getAttribute( 'aria-expanded' ) === 'true';\n\t\t\t\t\t\t\tsetAriaExpanded( toggle, ! isExpanded );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\n\t\t\t// =========================================================================\n\t\t\t// MEGA MENU SETUP\n\t\t\t// =========================================================================\n\t\t\tconst setupMegaMenu = ( link ) => {\n\t\t\t\tconst controlId = link.getAttribute( 'aria-controls' );\n\t\t\t\tconst megaMenu = document.getElementById( controlId );\n\n\t\t\t\tif ( ! megaMenu || link.hasAttribute( 'data-mega-nav-initialized' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlink.setAttribute( 'data-mega-nav-initialized', 'true' );\n\n\t\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'true' );\n\n\t\t\t\tconst menuItem = link.parentNode;\n\n\t\t\t\tif ( megaNavMode === 'hover' ) {\n\t\t\t\t\t// DESKTOP: Hover mode\n\t\t\t\t\tlet localHideTimer = null;\n\n\t\t\t\t\tconst showMenu = () => {\n\t\t\t\t\t\t// Cancel this menu's hide timer\n\t\t\t\t\t\tif ( localHideTimer ) {\n\t\t\t\t\t\t\tclearTimeout( localHideTimer );\n\t\t\t\t\t\t\tlocalHideTimer = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Close any other open mega menus\n\t\t\t\t\t\tcloseMegaMenus();\n\t\t\t\t\t\tcloseUtilityMenus();\n\n\t\t\t\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'false' );\n\t\t\t\t\t\tsetAriaExpanded( link, true );\n\t\t\t\t\t};\n\n\t\t\t\t\tconst hideMenu = () => {\n\t\t\t\t\t\t// Delay hiding just this menu\n\t\t\t\t\t\tlocalHideTimer = setTimeout( () => {\n\t\t\t\t\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t\t\t\tsetAriaExpanded( link, false );\n\t\t\t\t\t\t\tlocalHideTimer = null;\n\t\t\t\t\t\t}, HOVER_DELAY_MS );\n\t\t\t\t\t};\n\n\t\t\t\t\tconst cancelHide = () => {\n\t\t\t\t\t\tif ( localHideTimer ) {\n\t\t\t\t\t\t\tclearTimeout( localHideTimer );\n\t\t\t\t\t\t\tlocalHideTimer = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// Event wiring\n\t\t\t\t\tmenuItem.addEventListener( 'mouseenter', showMenu );\n\t\t\t\t\tmenuItem.addEventListener( 'mouseleave', hideMenu );\n\t\t\t\t\tmegaMenu.addEventListener( 'mouseenter', cancelHide );\n\t\t\t\t\tmegaMenu.addEventListener( 'mouseleave', hideMenu );\n\t\t\t\t} else {\n\t\t\t\t\t// TOUCH: Click mode - toggle mega menu open/closed (desktop only)\n\t\t\t\t\tlink.addEventListener( 'click', ( e ) => {\n\t\t\t\t\t\t// Only prevent default if mega menu is visible (not hidden on mobile)\n\t\t\t\t\t\tif ( megaMenu.offsetParent !== null ) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tconst isOpen = megaMenu.getAttribute( 'aria-hidden' ) === 'false';\n\n\t\t\t\t\t\t\tif ( isOpen ) {\n\t\t\t\t\t\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t\t\t\t\tsetAriaExpanded( link, false );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcloseAll();\n\t\t\t\t\t\t\t\tmegaMenu.setAttribute( 'aria-hidden', 'false' );\n\t\t\t\t\t\t\t\tsetAriaExpanded( link, true );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// On mobile (megaMenu.offsetParent === null), link works as normal navigation\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Keyboard support (works for both hover and touch modes)\n\t\t\t\tlink.addEventListener( 'keydown', ( e ) => {\n\t\t\t\t\thandleMenuItemKeyboard( e, link, megaMenu, closeAll );\n\t\t\t\t} );\n\n\t\t\t\tmegaMenu.addEventListener( 'keydown', ( e ) => {\n\t\t\t\t\thandleMegaMenuKeyboard( e, megaMenu, link );\n\t\t\t\t} );\n\t\t\t};\n\n\t\t\t// =========================================================================\n\t\t\t// UTILITY MENU\n\t\t\t// =========================================================================\n\t\t\tconst setupUtilityMenu = () => {\n\t\t\t\tif ( ! utilityMenu ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst topLevelItems = utilityMenu.querySelectorAll( ':scope > ul > li' );\n\n\t\t\t\ttopLevelItems.forEach( ( menuItem, index ) => {\n\t\t\t\t\tconst link = menuItem.querySelector( ':scope > a' );\n\t\t\t\t\tconst submenu = menuItem.querySelector( ':scope > ul' );\n\n\t\t\t\t\tif ( link && submenu ) {\n\t\t\t\t\t\tconst submenuId = `utility-submenu-${ index }`;\n\t\t\t\t\t\tsubmenu.setAttribute( 'id', submenuId );\n\t\t\t\t\t\tsubmenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t\t\tlink.setAttribute( 'aria-controls', submenuId );\n\t\t\t\t\t\tlink.setAttribute( 'aria-expanded', 'false' );\n\n\t\t\t\t\t\tif ( megaNavMode === 'hover' ) {\n\t\t\t\t\t\t\tconst showSubmenu = () => {\n\t\t\t\t\t\t\t\tcloseUtilityMenus();\n\t\t\t\t\t\t\t\tsetAriaExpanded( link, true );\n\t\t\t\t\t\t\t\tsubmenu.setAttribute( 'aria-hidden', 'false' );\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tconst hideSubmenu = () => {\n\t\t\t\t\t\t\t\tsetAriaExpanded( link, false );\n\t\t\t\t\t\t\t\tsubmenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tmenuItem.addEventListener( 'mouseenter', showSubmenu );\n\t\t\t\t\t\t\tmenuItem.addEventListener( 'mouseleave', hideSubmenu );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlink.addEventListener( 'click', ( e ) => {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\t\t\tconst isOpen = link.getAttribute( 'aria-expanded' ) === 'true';\n\n\t\t\t\t\t\t\t\tif ( isOpen ) {\n\t\t\t\t\t\t\t\t\t// Close this menu\n\t\t\t\t\t\t\t\t\tsetAriaExpanded( link, false );\n\t\t\t\t\t\t\t\t\tsubmenu.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// Close all utility menus, then open this one\n\t\t\t\t\t\t\t\t\tcloseUtilityMenus();\n\t\t\t\t\t\t\t\t\tsetAriaExpanded( link, true );\n\t\t\t\t\t\t\t\t\tsubmenu.setAttribute( 'aria-hidden', 'false' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Keyboard support (works for both hover and touch modes)\n\t\t\t\t\t\tlink.addEventListener( 'keydown', ( e ) => {\n\t\t\t\t\t\t\thandleMenuItemKeyboard( e, link, submenu, closeUtilityMenus );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tsubmenu.addEventListener( 'keydown', ( e ) => {\n\t\t\t\t\t\t\thandleMegaMenuKeyboard( e, submenu, link );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\n\t\t\t// =========================================================================\n\t\t\t// INITIALIZE ALL MENUS\n\t\t\t// =========================================================================\n\n\t\t\t// Setup mega menus (only within main navigation)\n\t\t\tmenu.querySelectorAll( '[aria-controls]' ).forEach( setupMegaMenu );\n\n\t\t\t// Setup dropdown toggles for mobile navigation\n\t\t\tsetupDropdownToggles( siteNav );\n\n\t\t\t// Setup utility menu (hover for desktop, click for touch)\n\t\t\tsetupUtilityMenu();\n\n\t\t\t// Make menu labels clickable\n\t\t\t// if (isTouchDevice) {\n\t\t\tdocument.querySelectorAll( '.menu-label' ).forEach( ( label ) => {\n\t\t\t\tconst dropdownToggle = label.nextElementSibling;\n\t\t\t\tif ( dropdownToggle && dropdownToggle.classList.contains( 'dropdown-toggle' ) ) {\n\t\t\t\t\tlabel.addEventListener( 'click', ( e ) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\tdropdownToggle.click();\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t\t// }\n\n\t\t\t// =========================================================================\n\t\t\t// GLOBAL CLICK OUTSIDE TO CLOSE\n\t\t\t// =========================================================================\n\n\t\t\tdocument.addEventListener( 'click', ( e ) => {\n\t\t\t\tconst clickedInsideNav = siteNav.contains( e.target );\n\t\t\t\tconst clickedInsideUtility = utilityMenu && utilityMenu.contains( e.target );\n\n\t\t\t\tif ( ! clickedInsideNav && ! clickedInsideUtility ) {\n\t\t\t\t\tcloseAll();\n\t\t\t\t\tsiteNav.classList.remove( 'toggled' );\n\t\t\t\t\tsetAriaExpanded( button, false );\n\t\t\t\t\tdocument.body.classList.remove( 'no-scroll' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Mark as initialized\n\t\t\tsiteNav.setAttribute( 'data-critical-nav-initialized', 'true' );\n\t\t\treturn true;\n\t\t}\n\n\t\t// Try to initialize immediately (script inlined in footer, after navigation HTML)\n\t\t// If navigation doesn't exist yet, wait for DOMContentLoaded as fallback\n\t\tconst hasNav = document.querySelector( \"[data-js-nav='main']\" );\n\n\t\tif ( hasNav ) {\n\t\t\t// Navigation exists, initialize immediately (before images load)\n\t\t\tinitNavigation();\n\t\t} else if ( document.readyState === 'loading' ) {\n\t\t\t// Fallback: wait for DOMContentLoaded\n\t\t\tdocument.addEventListener( 'DOMContentLoaded', initNavigation );\n\t\t} else {\n\t\t\t// DOM ready but nav missing, try init anyway\n\t\t\tinitNavigation();\n\t\t}\n\t} catch ( error ) {\n\t\tconsole.error( '[Navigation] Error:', error );\n\t}\n} )();\n"],"names":["ZotefoamsClassUtils","toggle","element","className","force","undefined","classList","add","classNames","remove","toggleAll","elements","map","addAll","forEach","removeAll","replace","oldClass","newClass","ZotefoamsDeviceUtils","isTouchDevice","window","navigator","maxTouchPoints","msMaxTouchPoints","getInteractionEvent","initTouchSupport","document","body","ZotefoamsAccessibilityUtils","getFocusableElements","container","Array","from","querySelectorAll","setAriaExpanded","expanded","setAttribute","toString","handleMegaMenuKeyboard","e","megaMenu","triggerLink","key","preventDefault","focus","focusable","currentIndex","indexOf","activeElement","isFirst","isLast","length","shiftKey","topLinks","index","targetLink","handleMenuItemKeyboard","link","closeAll","isOpen","getAttribute","firstFocusable","heading","querySelector","setTimeout","console","log","initNavigation","siteNav","hasAttribute","button","menu","utilityMenu","style","display","contains","megaNavMode","HOVER_DELAY_MS","allowHover","addEventListener","once","hideTimer","closeMegaMenus","clearTimeout","menuId","closeUtilityMenus","submenuId","submenu","getElementById","isExpanded","lastFocusable","setupDropdownToggles","parentNode","stopPropagation","setupMegaMenu","controlId","menuItem","localHideTimer","showMenu","hideMenu","cancelHide","offsetParent","setupUtilityMenu","topLevelItems","showSubmenu","hideSubmenu","label","dropdownToggle","nextElementSibling","click","clickedInsideNav","target","clickedInsideUtility","hasNav","readyState","error"],"mappings":"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"}